<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CrisisGo Chrome APP Test</title>
	<meta name="description" content="A list of A-Frame entries submitted to the js13kGames 2017 competition, used as an example for the MDN articles about Progressive Web Apps.">
	<meta name="author" content="end3r">
	<meta name="theme-color" content="#B12A34">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:image" content="icons/icon-512.png">
	<link rel="shortcut icon" href="icon-64.png">
	<link rel="stylesheet" href="style.css">
	<link rel="manifest" href="js13kpwa.webmanifest">
	<script src="data/games.js" defer></script>
	<script src="app.js" defer></script>
</head>
<body>
<!--<header>-->
<!--	<p><a class="logo" href="http://js13kgames.com"><img src="img/js13kgames.png" alt="js13kGames"></a></p>-->
<!--</header>-->
<h2>CrisisGo Chrome Web App Test</h2>
<button id="notifications" onclick="showAlert()" >Show Alert</button>

<main>
<!--	<h1>js13kGames A-Frame entries</h1>-->
<!--	<p class="description">List of games submitted to the <a href="http://js13kgames.com/aframe">A-Frame category</a> in the <a href="http://2017.js13kgames.com">js13kGames 2017</a> competition. You can <a href="https://github.com/mdn/pwa-examples/blob/master/js13kpwa">fork js13kPWA on GitHub</a> to check its source code.</p>-->

<!--	<h1>CrisisGo Chrome Web App Test</h1>-->
<!--	<button id="notifications" onclick="showAlert()" >Show Alert</button>-->
<!--	<section id="content"></section>-->
</main>
<!--<footer>-->
<!--	<button onclick="showAlert()">Alert Button3</button>-->
<!--	<p>&copy; js13kGames 2012-2018, created and maintained by <a href="http://end3r.com">Andrzej Mazur</a> from <a href="http://enclavegames.com">Enclave Games</a>.</p>-->
<!--</footer>-->

<script>
	var sleep=function (time) {
		var startTime=new Date().getTime()+parseInt(time,10);
		while(new Date().getTime()<startTime){};

	}
	function showAlert(){
		Notification.requestPermission().then((result) => {
			if (result === 'granted') {
				randomNotification();
			}
		});

	}




	// Setting up random Notification
	function randomNotification() {
		const randomItem = Math.floor(Math.random() * games.length);
		const notifTitle = 'Alert';
		const notifBody = `Active Shooter`;
		const notifImg = `data/img/shooter.png`;
		const options = {
			body: notifBody,
			icon: notifImg,
		};
		// 创建<audio>标签(参数:音频文件路径)
		const audio = new Audio('data/siren.mp3');
		// 播放声音
		audio.play();
		const notify=new Notification(notifTitle, options);
		notify.onclose=function() { audio.pause();};
		notify.onclick=function() { audio.pause(); };
		setTimeout(randomNotification, 30000);
		// var sleep=function (time) {
		//   var startTime=new Date().getTime()+parseInt(time,10);
		//   while(new Date().getTime()<startTime){};
		//
		// }
		// sleep(5000);
		// audio.pause();
	}
</script>
</body>
</html>